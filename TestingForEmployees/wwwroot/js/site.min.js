function AddNewTitleTest(){if(ValidateValue($("#titleTest").val())){$("#resultAddTitle").empty();var n=$("#titleTest").val();bootpopup({title:"Ви дійсно хочете додати тему для тестування?",content:[n],no:function(){},yes:function(){$.ajax({type:"post",url:"/Admin/AddNewTitle",dataType:"json",data:{newTitle:n},statusCode:{200:function(t){Confirmes("Нова тема успішно додана!",n);$("#titleTest").val("");$("#bodyTblTitle").empty();RestoreTableTitle(t)},400:function(){$("#titleTest").empty();Confirmes("Помилка","")}}})}})}else $("#resultAddTitle").empty(),$("#resultAddTitle").append("Заповніть тему"),Confirmes("Заповніть тему","")}function Confirmes(n,t){bootpopup({title:n,content:[t],button:["close"]})}function DateFormatting(n){var t=new Date(n);return dateFormat=t.getDate()+"."+t.getMonth()+"."+t.getFullYear()+":"+t.getHours()+"."+t.getMinutes()+"."+t.getSeconds()}function ValidateValue(n){if(n!==NaN&&n!==undefined&&n!=="")return!0}function RestoreTableTitle(n){for(var i=$("#bodyTblTitle"),t=0;t<n.length;t++)i.append("<tr><td title="+DateFormatting(n[t].dateAdd)+' id="title-'+n[t].id+'">'+n[t].title+'<\/td><td><button class="btn btn-table" id="btnDeleteTitle" title="Видалити тему" onclick="DeleteTitle('+n[t].id+')"><span class="glyphicon glyphicon-trash"><\/span><\/button><\/td><td><button class="btn btn-table" title="Редагувати" onclick="EditTitle('+n[t].id+')" id="btnEditTitle-'+n[t].id+'"><span class="glyphicon glyphicon-edit" ><\/span><\/button ><button class="btn btn-table hidden" title="Зберегти" onclick="SaveTitle('+n[t].id+')" id="btnSaveTitle-'+n[t].id+'"><span class="glyphicon glyphicon-floppy-saved"><\/span><\/button><\/td><td style="width:100px;" id="CountAllQuestion-'+n[t].id+'">'+n[t].questCount+'<\/td><td style="width:100px;"><input type="text" value="'+n[t].countTestQuestion+'" id="CountTestQuestion-'+n[t].id+'" class="form-control" disabled style="width:100px; margin:auto; text-align:center"/><\/td><\/tr>')}function DeleteTitle(n){var i="#title-"+n,t=$(i).text().trim();bootpopup({title:"Ви дійсно хочете видалити тему з тестування? всі питанні з даної теми будуть видалені повністю!",content:[t],no:function(){},yes:function(){$.ajax({type:"post",url:"/Admin/DeleteTitle",dataType:"json",data:{id:n},statusCode:{200:function(n){$("#resultAddTitle").empty();$("#resultAddTitle").append("Тему успішно видалено!");Confirmes("Тему успішно видалено",t);$("#titleTest").empty();$("#bodyTblTitle").empty();RestoreTableTitle(n)},400:function(){$("#resultAddTitle").empty();$("#resultAddTitle").append("помилка");$("#titleTest").empty();Confirmes("Помилка","")}}})}})}function EditTitle(n){var t,i,r;$("#btnEditTitle-"+n).addClass("hidden");$("#btnSaveTitle-"+n).removeClass("hidden");t=$("#title-"+n);i=t.text().trim();t.empty();r='<input type="text" name="EditTitle" class="form-control" value="'+i+'" id="inpNewTitle-'+n+'"/><span id="old-quest-'+n+'" style="display:none;">'+i+"<\/span>";t.append(r);$("#CountTestQuestion-"+n).removeAttr("disabled")}function SaveTitle(n){var r=$("#old-quest-"+n).text(),u=$("#CountAllQuestion-"+n).text(),t=$("#CountTestQuestion-"+n).val(),i;ValidateValue($("#inpNewTitle-"+n).val())&&ValidateValue(u)&&ValidateValue(t)&&!isNaN(parseInt(u,10))&&!isNaN(parseInt(t,10))?(i=$("#inpNewTitle-"+n).val(),bootpopup({title:"Редагувати тему: "+r+" на:",content:[i],no:function(){},yes:function(){var u=$("#inpNewTitle-"+n).val().trim();$.ajax({type:"post",url:"/Admin/EditTitle",dataType:"json",data:{EditTitle:u,id:n,CountTestQue:parseInt(t,10)},statusCode:{200:function(n){$("#titleTest").empty();$("#bodyTblTitle").empty();RestoreTableTitle(n);Confirmes("Тему: "+r+" успішно змінено на:",i)},400:function(){$("#titleTest").empty();Confirmes("Помилка","")}}})}})):Confirmes("Дані що внесені невірні, перевірте","")}function DeleteQuestion(n){if(ValidateValue(n)){var t=$("#quest-text-"+n).text(),i=$("#selectTitle").val();bootpopup({title:"Відалити питання з теми?<h3>"+$("#selectTitle option:selected").text()+"<\/h3>",content:[t],no:function(){},yes:function(){$.ajax({type:"post",url:"/Admin/DeleteQuest",dataType:"json",data:{idQuest:n,idTitle:i},statusCode:{200:function(n){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("питання знайдені!");$("#bodyTblQuestion").empty();Confirmes("Питання успішно видалені","");RestoreTableQuestion(n);RemoveInputAll("addQuestionContainer")},400:function(){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("помилка");Confirmes("Помилка","")}}})}})}}function SelectTitle(){ValidateValue($("#selectTitle").val())&&(CloseAnswer(),$.ajax({type:"post",url:"/Admin/GetGuestion",dataType:"json",data:{idTitle:$("#selectTitle").val()},statusCode:{200:function(n){$("#resultFindQuestion").empty();$("#bodyTblQuestion").empty();RestoreTableQuestion(n);RemoveInputAll("addQuestionContainer")},400:function(){$("#resultFindQuestion").empty();Confirmes("Помилка","")}}}))}function RestoreTableQuestion(n){for(var i=$("#bodyTblQuestion"),t=0;t<n.length;t++){var r='<button class="btn btn-table" onclick="DeleteQuestion('+n[t].id+')" id="quest-'+n[t].id+'"><span class="glyphicon glyphicon-trash"><\/span><\/button>',u='<button id="editquest-'+n[t].id+'" class="btn btn-table" onclick="EditQuestion('+n[t].id+')"><span class="glyphicon glyphicon-edit"><\/span><\/button>',f='<button id="savequest-'+n[t].id+'" class="btn btn-table hidden" title="Зберегти" onclick="SaveQuestion('+n[t].id+')" id="btnSaveQuest-'+n[t].id+'"><span class="glyphicon glyphicon-floppy-saved"><\/span><\/button>',e='<button class="btn btn-table" id="selectBtnQuest-'+n[t].id+'" onclick="SelectQuest('+n[t].id+')"><span class="glyphicon glyphicon-folder-open"><\/span><\/button>';i.append('<tr id="quest-select-'+n[t].id+'"><td id="quest-text-'+n[t].id+'">'+n[t].questions+"<\/td><td>"+r+"<\/td><td>"+u+f+"<\/td><td>"+e+"<\/td><tr>")}}function RemoveInnerClass(n,t){var r=$("."+t),i=$("#"+n).find(r);i.length>0&&$("#"+i[0].id).removeClass(t)}function SelectQuest(n){$("#Answer-container-wrap").detach();RemoveInnerClass("tableQuest","select");ValidateValue(n)&&($("#quest-select-"+n).hasClass("select")?$("#quest-select-"+n).removeClass("select"):($("#quest-select-"+n).addClass("select"),$.ajax({type:"post",url:"/Admin/GetQuestion",dataType:"json",data:{idQuest:n},statusCode:{200:function(t){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("відповіді змінено!");AnswerRender(t,n)},400:function(){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("помилка");Confirmes("Помилка","")}}})))}function SaveAnswer(n){var u,r,t,i,f,h;if(ValidateValue(n)&&increm>1){for(u=!0,r=[],t=1;t<increm;t++)if(i=$("#quest-inp-"+t),f=$("#someSwitchOptionPrimary-"+t),i&&f)if(ValidateValue($.trim(i.val()))){var e=f.is(":checked")?!0:!1,o=$.trim(i.val()),s={};s.Answers=o;s.State=e;r.push({Answers:o,State:e})}else u=!1,i.attr("placeholder","Питання повинно бути заповнене!!!");u&&r.length>0&&(h={IdQue:n,CollAnswers:r},$.ajax({type:"post",url:"/Admin/AddAnswers",contentType:"application/json",data:JSON.stringify(h),statusCode:{200:function(){CloseAnswer();Confirmes("Відповіді успішно додані","")},400:function(){Confirmes("Помилка","")}}}))}}function AnswerRender(n,t){var i,f,u,s;increm=1;var e='<div id="Answer-container"  data-idQuestion="'+t+'">',r="",o='<div><button class="btn btn-table" onclick="AddOneAnswer(\'Answer-container\')"><span class="glyphicon glyphicon-plus"><\/span><\/button><button class="btn btn-table" onclick="RemoveAnswerOne(\'Answer-container\')"><span class="glyphicon glyphicon-minus"><\/span><\/button><button class="btn btn-table" onclick="SaveAnswer('+t+')"><span class="glyphicon glyphicon-floppy-saved"><\/span> Зберегти<\/button><\/div>';for(n.length==0&&(r="<h4 id='answerIsNull'>По даному питанню відповідей немає<\/h4>"),i=0;i<n.length;i++)increm=i+1,f=n[i].state===!0?"checked":NaN,r=r+'<div class="input-group"><input type="text" value="'+n[i].title+'" id="quest-inp-'+increm+'" class="form-control" aria-describedby="tr1" ><span id="tr1" class="input-group-addon"><div class="material-switch pull-right"><input id="someSwitchOptionPrimary-'+increm+'" name="someSwitchOption001" type="checkbox" '+f+'/><label for="someSwitchOptionPrimary-'+increm+'" class="label-primary"><\/label><\/div><\/span><\/div>';$("#tableQuest").append('<div class="container answ-container" id="Answer-container-wrap"><div class="closeBtn"><button type="button" class="close" aria-label="Close" onclick="CloseAnswer()"><span aria-hidden="true">&times;<\/span><\/button><\/div>'+e+r+"<\/div>"+o+"<\/div>");u=$("#selectBtnQuest-"+t).offset();s=$("#Answer-container-wrap").offset({left:u.left-600,top:u.top})}function RemoveAnswerOne(n){if($("div").is("#"+n)){var t=$("#"+n).children(".input-group").last();t.detach();increm>1&&increm--;increm<=1&&($("#answerIsNull").empty(),$("#answerIsNull").append('<h4 id="answerIsNull">По даному питанню відповідей немає<\/h4>'))}}function AddOneAnswer(n){if($("div").is("#"+n)){var t=$("#"+n).find("input[type=text]");t.size()>0&&(increm=t.size()+1);$("#answerIsNull").empty();$("#Answer-container-wrap").offset({top:$("#Answer-container-wrap").offset().top-35});$("#"+n).append('<div class="input-group"><input type="text" value="" placeholder="Нова відповідь" class="form-control" aria-describedby="tr1" id="quest-inp-'+increm+'"><span id="tr1" class="input-group-addon"><div class="material-switch pull-right"><input id="someSwitchOptionPrimary-'+increm+'" name="someSwitchOption001" type="checkbox" /><label for="someSwitchOptionPrimary-'+increm+'" class="label-primary"><\/label><\/div><\/span><\/div>');increm++}}function CloseAnswer(){$("#Answer-container-wrap").detach()}function EditQuestion(n){var t,i;ValidateValue(n)&&($("#editquest-"+n).addClass("hidden"),$("#savequest-"+n).removeClass("hidden"),t=$("#quest-text-"+n).text().trim(),$("#quest-text-"+n).empty(),i='<input type="text" id="quest-text-inp'+n+'" value="'+t+'" name="NewQuest" class="form-control" data-content-old="'+t+'"/>',$("#quest-text-"+n).append(i))}function SaveQuestion(n){ValidateValue(n)&&bootpopup({title:"Змінити питання? - <h4>"+$("#quest-text-inp"+n).attr("data-content-old")+"<\/h4> на:",content:["<h4>"+$("#quest-text-inp"+n).val()+"<\/h4>"],no:function(){},yes:function(){$.ajax({type:"post",url:"/Admin/EditQuestion",dataType:"json",data:{idQuest:n,EditQuest:$.trim($("#quest-text-inp"+n).val()),idTitle:$("#selectTitle").val()},statusCode:{200:function(n){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("питання змінено!");$("#bodyTblQuestion").empty();Confirmes("Питання успішно змінені","");RestoreTableQuestion(n);RemoveInputAll("addQuestionContainer")},400:function(){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("помилка");Confirmes("Помилка","")}}})}})}function AddInput(n){counter++;var t=$("#"+n),i="'wrap-quest-"+counter+"'";t.append('<div id="wrap-quest-'+counter+'" class="wrap-quest"><input type="text" name="quest-'+counter+'" id="newQuest-'+counter+'" value="" class="form-control form-group-sm"/><button class="btn btn-table"onclick="RemoveOneQuest('+i+')"><span class="glyphicon glyphicon-minus"><\/span><\/button><\/div>')}function RemoveInputAll(n){var t=$("#"+n);t.empty();counter=0}function RemoveOneQuest(n){var t=$("#"+n);t.detach()}function SaveInputQuestion(){var i,r,n,u;if(counter>0){var f=$("#selectTitle option:selected").text(),e=$("#selectTitle").val(),t=[];for(n=1;n<=counter;n++)i=$("#newQuest-"+n).val(),i!==NaN&&i!==undefined&&i!==""&&t.push($.trim(i));if(r="<h3>"+f+"<\/h3><hr>",t.length>0)for(n=0;n<t.length;n++)r=r+"<p>"+t[n]+"<\/p>";u={IdTitle:e,Questions:t};bootpopup({title:"Бажаете додати питання для тесту?",content:[r],no:function(){},yes:function(){$.ajax({type:"post",url:"/Admin/AddQuestionsToTitle",contentType:"application/json",headers:{Accept:"application/json"},dataType:"json",data:JSON.stringify(u),statusCode:{200:function(n){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("питання знайдені!");$("#bodyTblQuestion").empty();Confirmes("Питання успішно додані","");RestoreTableQuestion(n);RemoveInputAll("addQuestionContainer")},400:function(){$("#resultFindQuestion").empty();$("#resultFindQuestion").append("помилка");Confirmes("Помилка","")}}})}})}else Confirmes("Немає питань які потрібно додати","")}function AccessChangeSave(n,t){if(ValidateValue(n)&&ValidateValue(t)){var i=$("#select-attempts-"+t+" option:selected").text(),r=$("#state-access-"+t).is(":checked")?!0:!1;$.ajax({type:"post",url:"/Access/AccessChange",dataType:"json",data:{AccessCount:i,AccessState:r,UserId:n,AccessId:t},statusCode:{200:function(){Confirmes("Статус змінено","");window.location.reload()},400:function(){Confirmes("Помилка","Кількість спроб не може бути більше 0 якщо статус вимкнений")}}})}}var increm,counter;$(window).resize(function(){$("#Answer-container-wrap")&&$("#Answer-container-wrap").detach()});increm=1;counter=0;